# Scripts_and Data_AFMChromosomes_manuscript

## Content
The repository contains the scripts that were used for processing the data from the AFM and that produced the results shown within the manuscript. The content of each folder is:  
1. ***RawData_ProcessingScripts***: this folder contains two subfolders each of which contains both the raw force curves data (in the respective subfolders) and the scripts for processing them, for the experiments of i) indentations across the chromatids and ii) indentations along chromatids (peripheral, centromeric and mid-arm regions). The scripts are used to process the raw force curves and produce the content of the folders *parallelization_results_20230824* (in "Mechanics_RepeatedIndentations_AcrossChromatids") and *20230824* (in "Mechanics_along_chromatids"), which are then used in the successive analyses. 
2. ***Mechanics_RepeatedIndentations_AcrossChromatids***: this folder contains all the data and scripts that are used for producing the content of Figure 2 and 4 in the manuscript. Regarding Figure 2, data are contained within the *Point_variability_analysis* and *Representative_Chromosomes_AFM_curves* folders; the Figure 2 results are then generated using _Fig_SamePointCurveVariability_DataPlotting.py_. For Figure 4, the folder *parallelization_results_20230824* contains all the results from the analysis of the raw force curves (RawData_ProcessingScripts). These data are then wrapped together using *StackingParallelizationResults.py*, which generates 4 .txt files (...ViscIndex_Across...AllData10, ...ViscIndex_Across...AllData20, ...YM_Across...AllData10 and ...YM_Across...AllData20) that contains the results of Young Modulus and Viscoelasticity index used by the script *Fig_MechanicsAcrossChromatids.py* to produce the plots shown in Figure 4 in the manuscript. Images *Chromatids_CrossSection.png* and *Chromosome_indentationGrid_CCA.tiff* are also fed into the script.
3. ***Mechanics_along_chromatids***: this folder contains the data and scripts used to produce the figures related to indentations performed in different parts of the chromatids (mid-arm, peripheral and centromeric regions). The folder *20230824* contains the results obtained from processing all the force curves (divided by chromosome, using the appropriate scripts within the RawData_ProcessingScripts folder); these results are then wrapped into two .txt files by *StackingParallelizationResults.py*. The two .txt files (*20230824_ViscIndex_Indentation_parts...txt* and *20230824_YM_Indentation_parts...txt*) are then used by *Fig_YM_ViscIndex_Centromere_Telomere_Arms_Analysis&Plotting.py* to produce the appropriate figures.  
4. ***AFM Rheology Data***: this folder contains all the data and analyses related to the microrheology measurements. The folder *Probed_chromosomes* is available at ??? and needs to be copied in this directory before running the scripts. The folder contains the raw data of all the probed chromosomes and the results of the analyses performed using the proprietary Bruker-JPK software (contained within each subfolder as a .tsv file). The .txt file name *Rheology_results_allChrms.txt* has been generated by *Rheology_RheoParameters.py*, which reads the results of the rheological analysis of each chromosome (.tsv file located within their respective folders) and stack them together in *Rheology_results_allChrms.txt*. These data are used by *AFMCurve_RheoParameters.py* to create all the plots shown in figure 3 of the paper. *Representative_ForceTime_curves* contains some representative force curves obtained during the experiments. *Representative_AFM-RheoCurve.py* imports the curve files from the folder and extract the useful information for plotting a representative force curve, it then stores the curve points in an homonymous .txt file (also used by the script that generates the plots for Figure 3). *Rheology_curveReader.py* extract the Relaxation part of each force curve, computes the average force-curve for each of the probed chromosomes and then fit them with a double exponential function. It then stores all the average force-relaxation curves in *Average_ForceRelax_curves.txt* and their fits in *Fit_ForceRelax_curves.txt*; finally, it also generates *Fitting_parameters.txt* which contains all the parameters from the fits (displayed in Table S1 in the manuscript). All the generated .txt files are imported into *AFMCurve_RheoParameters.py* and used to produce the panels shown in Figure 2 of the manuscript.  
5. ***Chromatin_HeightDistribution***: The matlab script *masked_height_update.mat* takes as input the height distribution of the masked points obtained using Gwyddion (http://gwyddion.net) and calculates a Gaussian Mixture model that fits the distribution with 5 gaussian distribution curves. The results are exported as .txt (_20231117_ChromatinDistribution_points.txt_)_and .dat (_five_gaussians.dat_) files, which are then used by _MultiGauss.py_ to produce the figure in the manuscript.
6. ***AFM_ChromatinCorrelation***: This folder contains the script for the roughness analysis of the chromosome surface. The sub-folder "_Chromosome_" contains the raw data; longitudinal and perpendicular profiles have been obtained using Gwyddion and are saved in .txt/.csv files. These data are processed by _ChromatinCorrelation_Plots.py_ which computes the scaling exponent for the two batches of profiles and generates the figures shown in the manuscript.
7. ***Images_AcrossChromatids_ChromosomeWidth_calculation***: this folder contains the raw AFM images and their analysis using Gwyddion in order to extract the width values used for Figure 4 e. The results from all width values of the different images is wrapped up in the excel file "Chrms_AcrossChromatids_WidthValues.xlsx".

## Workflow
***How to use the scripts within the RawData_ProcessingScripts folder:*** to process the raw data contained within the "IndentationAcrossChromatids" folder, located within the "AFM_CurvesAcrossChromatids_AllData10" and "AFM_CurvesAcrossChromatids_AllData20" folders, the scripts called "viscoelasticity...Parallelization10.py", "viscoelasticity...Parallelization20.py", "YM...Parallelization10.py" and "YM...Parallelization20.py" should be run leveraging parallelization, this can be done from the terminal. Open a terminal window from the directory where these scripts are stored, type:

for i in{0..n); do python3 YM_analysis_SingleChrm_Parallelization10.py $i & done

(in this case for the calculation of the YM for the data contained within the "...AllData10"folder), replacing “n” with the number of chromosomes (folders) that are present in the directory - 1; e.g. in this case the "...AllData10" folder contains 11 subfolders (i.e., 11 chromosomes) so n will be equal to 10. Repeating this for the 4 above-mentioned scripts will populate the folder "parallelization_results_20240424" with all the data necessary for the successive analyses. This folder is copied into "Mechanics_RepeatedIndentations_AcrossChromatids" for the successive analyses and plots generation.

The same procedure is performed for processing the raw files in the folder "Chromosome_indentations", within the "IndentationAlongChromatids" main folder. Here, only two "...Parallelization.py" scripts are present and they will populate the folder "20240424"; this folder is copied into "Mechanics_along_chromatids" for generating the respective plots. More details about the individual scripts present in these folders can be found at https://github.com/AndreaRid/NanoscopeAFM_ForceCurve_analysis

***Generating the plots shown in the manuscript:*** once the scripts within the "RawData_ProcessingScripts" folder have been run correctly and after copying the two resulting folders (mentioned above) into the appropriate analysis folders, it's sufficient to run each scripts listed in the content section for generating the respective data and plots.
